(defndynamic curry-generate-args [n]
  (if (= n 0)
    '()
    (cons (Symbol.join ['arg (Symbol.from n)]) (curry-generate-args (- n 1)))))

(defndynamic curry-internal [n f]
  (if (= n 0)
    f
    (curry-internal
      (- n 1)
      (list 'fn (array (Symbol.join ['arg (Symbol.from n)])) f))))

(defndynamic curry [f]
  (curry-internal (arity f) (cons (cadr f) (reverse (curry-generate-args (arity f))))))
